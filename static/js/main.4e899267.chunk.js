(this["webpackJsonptemplate-react-app"]=this["webpackJsonptemplate-react-app"]||[]).push([[0],{27:function(e,t,n){},34:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),o=n(15),a=n.n(o),r=(n(27),n(4)),i=n(5),j=n(3),u=n(21),l=n(12),b="AUTH_USER",d="DISCONNECT_USER",h={is_connected:!1,user:{}},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return Object(l.a)(Object(l.a)({},e),{},{is_connected:!0,user:t.user});case d:return Object(l.a)(Object(l.a)({},e),{},{is_connected:!1});default:return e}},p=Object(u.a)(O,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),m=n(0),f=function(){return Object(m.jsx)("nav",{className:"h-10 w-full border-b border-1 my-2",children:Object(m.jsxs)("div",{children:[Object(m.jsx)(r.b,{to:"/home",className:"mx-2",children:"Accueil"}),Object(m.jsx)(r.b,{to:"/sign-up",className:"mx-2",children:"Sign Up"}),Object(m.jsx)(r.b,{to:"/log-in",className:"mx-2",children:"Login"})]})})},x=n(6),v=n.n(x),g=function(e){return{type:b,user:e}},N=function(){var e=Object(j.b)();return Object(m.jsx)("nav",{className:"h-10 w-full border-b border-1 my-2",children:Object(m.jsxs)("div",{children:[Object(m.jsx)(r.b,{to:"/home",className:"mx-2",children:"Accueil"}),Object(m.jsx)(r.b,{to:"/profile",className:"mx-2",children:"Profile"}),Object(m.jsx)("button",{onClick:function(t){t.preventDefault(),v.a.remove("token"),e({type:d})},className:"btn btn-sm",children:"Sign Out"})]})})},y=function(){var e=Object(j.c)((function(e){return e.is_connected})),t=Object(j.b)();return s.a.useEffect((function(){v.a.get("token")&&fetch("http://localhost:1337/users/me",{method:"get",headers:{Authorization:"Bearer ".concat(v.a.get("token")),"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){t(g(e))}))}),[]),Object(m.jsx)("nav",{className:"h-10 w-full border-b border-1 my-2",children:Object(m.jsx)("div",{children:e?Object(m.jsx)(N,{}):Object(m.jsx)(f,{})})})},S=n(22),k=function(e){var t=e.component,n=Object(S.a)(e,["component"]),c=Object(j.c)((function(e){return e.is_connected}));return Object(m.jsx)(i.b,Object(l.a)(Object(l.a)({},n),{},{render:function(e){return c?Object(m.jsx)(t,Object(l.a)({},e)):Object(m.jsx)(i.a,{to:{pathname:"/log-in"}})}}))},w=n(7),E=function(){var e=s.a.useState(""),t=Object(w.a)(e,2),n=t[0],c=t[1],o=Object(j.c)((function(e){return e.is_connected})),a=Object(j.b)();return Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{children:Object(m.jsx)("p",{children:n})}),Object(m.jsxs)("form",{onSubmit:function(e){var t=Object.fromEntries(new FormData(document.querySelector("form")));e.preventDefault(),fetch("http://localhost:1337/auth/local/register",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){v.a.set("token",e.jwt),c("You are logged in."),a(g())})).catch((function(e){c(e.message)}))},children:[Object(m.jsx)("label",{children:"Username"}),Object(m.jsx)("input",{name:"username"}),Object(m.jsx)("br",{}),Object(m.jsx)("label",{children:"email"}),Object(m.jsx)("input",{name:"email"}),Object(m.jsx)("br",{}),Object(m.jsx)("label",{children:"Password"}),Object(m.jsx)("input",{name:"password"}),Object(m.jsx)("br",{}),Object(m.jsx)("input",{type:"submit",value:"Submit"})]}),o&&window.location.href.includes("sign")?Object(m.jsx)(i.a,{to:{pathname:"/home"}}):Object(m.jsx)("p",{})]})},_=function(){return Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{children:"Please, sign up to continue."}),Object(m.jsx)(E,{}),Object(m.jsx)("p",{children:"Already registered ?"}),Object(m.jsx)(r.b,{to:"/log-in",className:"mx-2",children:"Please log in !"})]})},T=function(){var e=s.a.useState(""),t=Object(w.a)(e,2),n=t[0],c=t[1],o=Object(j.c)((function(e){return e.is_connected})),a=Object(j.b)();return Object(m.jsxs)("div",{children:[Object(m.jsx)("div",{children:Object(m.jsx)("p",{children:n})}),Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=Object.fromEntries(new FormData(document.querySelector("form")));fetch("http://localhost:1337/auth/local",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){v.a.set("token",e.jwt),c("You are logged in."),a(g(e.user))})).catch((function(e){c(e.message)}))},children:[Object(m.jsx)("label",{children:"email"}),Object(m.jsx)("input",{name:"identifier"}),Object(m.jsx)("br",{}),Object(m.jsx)("label",{children:"Password"}),Object(m.jsx)("input",{name:"password"}),Object(m.jsx)("br",{}),Object(m.jsx)("input",{type:"submit",value:"Submit"})]}),o&&window.location.href.includes("log")?Object(m.jsx)(i.a,{to:{pathname:"/home"}}):Object(m.jsx)("p",{})]})},C=function(){return Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{children:"Please log in to continue !"}),Object(m.jsx)(T,{}),Object(m.jsx)("p",{children:"Not registered yet ?"}),Object(m.jsx)(r.b,{to:"/sign-up",className:"mx-2",children:"Please sign up !"})]})},D=function(e){var t=Object(j.c)((function(e){return e.user})),n=s.a.useState(e.likes),c=Object(w.a)(n,2),o=c[0],a=c[1],r=s.a.useState("not-liked"),i=Object(w.a)(r,2),u=i[0],l=i[1];s.a.useEffect((function(){localStorage.getItem("post-".concat(e.id))&&l("liked")}),[]);var b=function(t){var n={like:t};return fetch("http://localhost:1337/posts/".concat(e.id),{method:"put",headers:{Authorization:"Bearer ".concat(v.a.get("token")),"Content-Type":"application/json"},body:JSON.stringify(n)})};return Object(m.jsxs)("div",{children:["liked"===u?Object(m.jsx)("button",{onClick:function(){var t=o-1;b(t).then((function(e){return e.json()})).then((function(n){a(t),l("not-liked"),localStorage.removeItem("post-".concat(e.id))}))},className:"heart inline",children:"\u2764"}):Object(m.jsx)("button",{onClick:function(){var n=o+1;b(n).then((function(e){return e.json()})).then((function(c){a(n),l("liked"),localStorage.setItem("post-".concat(e.id),"{\n          status: 'liked',\n          user: ".concat(t.id,"\n        }"))}))},className:"heart inline",children:"\u2661"}),o>0?Object(m.jsxs)("p",{className:"inline ml-2",children:["Il y a actuellement ",o," likes sur ce post."]}):Object(m.jsx)("p",{className:"inline ml-2",children:"Il n'y a pas encore de likes sur ce post."})]})},A=function(e){var t=s.a.useState(!1),n=Object(w.a)(t,2),c=n[0],o=n[1],a=Object(j.c)((function(e){return e.user}));return s.a.useEffect((function(){e.data.user.id===a.id&&o(!0)}),[]),Object(m.jsxs)("div",{className:"post-container my-1",children:[Object(m.jsx)("h3",{className:"inline",children:e.data.text}),c?Object(m.jsx)("i",{className:"fas fa-trash-alt inline ml-2",onClick:function(){e.deletePost(e.data.id)}}):Object(m.jsx)("p",{}),Object(m.jsxs)(r.b,{to:"/users/".concat(e.data.user.id),className:"block",children:["- ",e.data.user.username]}),Object(m.jsx)(D,{likes:e.data.like,id:e.data.id})]})},P=function(e){var t=Object(j.c)((function(e){return e.user}));return Object(m.jsxs)("form",{onSubmit:function(t){t.preventDefault();var n=Object.fromEntries(new FormData(document.querySelector("form")));fetch("http://localhost:1337/posts",{method:"post",headers:{Authorization:"Bearer ".concat(v.a.get("token")),"Content-Type":"application/json"},body:JSON.stringify(n)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){e.updatePosts()})).catch((function(e){console.log(e)}))},className:"container",children:[Object(m.jsx)("label",{className:"block",children:"New post's text"}),Object(m.jsx)("input",{name:"text",className:"input"}),Object(m.jsx)("input",{type:"hidden",name:"user",value:t.id}),Object(m.jsx)("input",{type:"submit",value:"Share",className:"submit"})]})},I=function(){var e=s.a.useState([]),t=Object(w.a)(e,2),n=t[0],c=t[1],o=function(){fetch("http://localhost:1337/posts",{method:"get",headers:{Authorization:"Bearer ".concat(v.a.get("token")),"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){c(e)}))},a=function(e){fetch("http://localhost:1337/posts/".concat(e),{method:"delete",headers:{Authorization:"Bearer ".concat(v.a.get("token")),"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){o()}))};return s.a.useEffect((function(){o()}),[]),Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{children:"Feed"}),Object(m.jsx)(P,{updatePosts:o}),Object(m.jsx)("div",{className:"",children:n.map((function(e,t){return Object(m.jsx)(A,{data:e,deletePost:a},t)}))})]})},B=function(e){return Object(m.jsx)("div",{className:"post-container my-1",children:Object(m.jsx)("h3",{className:"inline",children:e.data.text})})},U=function(){var e=s.a.useState([]),t=Object(w.a)(e,2),n=t[0],c=t[1];return s.a.useEffect((function(){fetch("http://localhost:1337/posts",{method:"get",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){c(e)}))}),[]),Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{children:"Feed"}),Object(m.jsx)("div",{className:"",children:n.map((function(e,t){return Object(m.jsx)(B,{data:e},t)}))})]})},z=function(){var e=Object(j.c)((function(e){return e.is_connected}));return Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{children:"Welcome !"}),Object(m.jsx)("p",{children:"Welcome on My Social Network. This website is a training to Redux and React. We use auth and routing to create a small social media website."}),e?Object(m.jsx)(I,{}):Object(m.jsx)(U,{})]})},J=function(){var e=Object(j.c)((function(e){return e.user}));return Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{children:"User Profile"}),Object(m.jsxs)("h3",{children:["Welcome ",e.username," !"]}),Object(m.jsxs)("p",{children:["Email address used : ",e.email]}),Object(m.jsx)(r.b,{to:"/update-profile",children:"Update profile"})]})},F=function(){var e=Object(j.c)((function(e){return e.user})),t=s.a.useState(""),n=Object(w.a)(t,2),c=n[0],o=n[1];return Object(m.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t=Object.fromEntries(new FormData(document.querySelector("form")));fetch("http://localhost:1337/users/me",{method:"put",headers:{Authorization:"Bearer ".concat(v.a.get("token")),"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){o("update_done")})).catch((function(e){console.log(e)}))},className:"container",children:[Object(m.jsx)("label",{children:"Email"}),Object(m.jsx)("input",{name:"email",value:e.email}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("label",{children:"Description"}),Object(m.jsx)("input",{name:"description"}),Object(m.jsx)("br",{}),Object(m.jsx)("br",{}),Object(m.jsx)("input",{type:"submit",value:"Submit"}),"update_done"===c?Object(m.jsx)(i.a,{to:{pathname:"/profile"}}):Object(m.jsx)("p",{})]})},R=function(){var e=s.a.useState(""),t=Object(w.a)(e,2),n=t[0],c=t[1],o=s.a.useState([]),a=Object(w.a)(o,2),r=a[0],j=a[1],u=Object(i.g)().userId;return s.a.useEffect((function(){fetch("http://localhost:1337/posts?user.id=".concat(u),{method:"get",headers:{Authorization:"Bearer ".concat(v.a.get("token")),"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){e.length>0&&j(e)}))}),[]),s.a.useEffect((function(){fetch("http://localhost:1337/users/".concat(u),{method:"get",headers:{Authorization:"Bearer ".concat(v.a.get("token")),"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){c(e)}))}),[]),Object(m.jsxs)("div",{className:"container",children:[Object(m.jsx)("h2",{children:n.username}),Object(m.jsx)("p",{children:n.description}),Object(m.jsx)("div",{className:"grid grid-cols-3 gap-4",children:r.map((function(e,t){return Object(m.jsx)(A,{data:e},t)}))})]})},q=function(){return Object(m.jsx)(j.a,{store:p,children:Object(m.jsxs)(r.a,{children:[Object(m.jsx)(y,{}),Object(m.jsxs)(i.d,{children:[Object(m.jsx)(i.b,{path:"/sign-up",component:_}),Object(m.jsx)(i.b,{path:"/log-in",component:C}),Object(m.jsx)(k,{path:"/profile",component:J}),Object(m.jsx)(k,{path:"/update-profile",component:F}),Object(m.jsx)(k,{path:"/posts",component:I}),Object(m.jsx)(k,{path:"/users/:userId",component:R}),Object(m.jsx)(i.b,{path:"/home",component:z})]})]})})};a.a.render(Object(m.jsx)(q,{}),document.getElementById("root"))}},[[34,1,2]]]);
//# sourceMappingURL=main.4e899267.chunk.js.map